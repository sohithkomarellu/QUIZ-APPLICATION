<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Teacher Dashboard - Quiz Application</title>
     <link rel="stylesheet" href="style.css">
</head>
<body>

<body>
<div class="app">

    <header>
        <h1>Teacher Dashboard</h1>
        <p>Manage Questions and Quizzes</p>
    </header>

    <div class="main-layout">

        <!-- Sidebar -->
        <div class="sidebar">
            <a href="index.html"> Home</a>
            <a href="add-question.html"> Add Question</a>
            <a href="create-quiz.html"> Create Quiz</a>
            <a href="take-quiz.html"> Student View</a>
        </div>

        <!-- Content -->
        <div class="content">

            <section>
                <h2>Dashboard Overview</h2>
                <p>Total Questions: <span id="totalQuestions">--</span></p>
                <p>Categories Available: <span id="totalCategories">--</span></p>
            </section>

            <section>
                <h2>Filter Questions by Category</h2>
                <input type="text" id="categoryInput" placeholder="Enter category">
                <button onclick="filterByCategory()">Search</button>
                <button onclick="loadAllQuestions()">View All</button>
            </section>

            <section>
                <h2>All Questions</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Question</th>
                            <th>Category</th>
                            <th>Difficulty</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="questionTableBody"></tbody>
                </table>
            </section>

        </div>
    </div>


</div>


    <!-- JavaScript -->
    <script>
        // Load all questions when page loads
        window.onload = function() {
            loadAllQuestions();
        };

        // 1️⃣ Load all questions (GET /question/allquestions)
        function loadAllQuestions() {
            fetch("/question/allquestions")
                .then(response => response.json())
                .then(data => {
                    displayQuestions(data);
                    document.getElementById("totalQuestions").innerText = data.length;
                })
                .catch(error => {
                    alert("Error loading questions");
                    console.error(error);
                });
        }

        // 2️⃣ Filter questions by category (GET /question/category/{category})
        function filterByCategory() {
            const category = document.getElementById("categoryInput").value;

            if (category === "") {
                alert("Please enter a category");
                return;
            }

            fetch(`/question/category/${category}`)
                .then(response => response.json())
                .then(data => {
                    displayQuestions(data);
                })
                .catch(error => {
                    alert("Error filtering questions");
                    console.error(error);
                });
        }

        // 3️⃣ Delete question (DELETE /question/delete/{id})
        function deleteQuestion(id) {
            const confirmDelete = confirm("Are you sure you want to delete this question?");
            if (!confirmDelete) return;

            fetch(`/question/delete/${id}`, {
                method: "DELETE"
            })
            .then(() => {
                alert("Question deleted successfully");
                loadAllQuestions();
            })
            .catch(error => {
                alert("Error deleting question");
                console.error(error);
            });
        }

        // 4️⃣ Display questions in table
        function displayQuestions(questions) {
            const tableBody = document.getElementById("questionTableBody");
            tableBody.innerHTML = "";

            if (questions.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="5" align="center">No questions found</td>
                    </tr>
                `;
                return;
            }

            questions.forEach(q => {
                const row = `
                    <tr>
                        <td>${q.id}</td>
                        <td>${q.questionTitle}</td>
                        <td>${q.category}</td>
                        <td>${q.difficultyLevel}</td>
                        <td>
                            <button onclick="deleteQuestion(${q.id})">Delete</button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }
    </script>

</body>
</html>
